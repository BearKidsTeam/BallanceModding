# Ballance Modding

Files for modding of a game named [*Ballance*](https://en.wikipedia.org/wiki/Ballance).

## What are these files?

They are files created with Virtools, containing logic scripts and data for *Ballance*. You can find them in your *Ballance* installation path. The files in this repository are the deobfuscated version of the corresponding files, created specifically for modders.

## What is the 'deobfuscated version' and why?

Virtools behaviors are programmed in a way called control flow graph, and can be edited with the schematic view in Virtools. However, the graph data of *Ballance* scripts is removed upon its release, making Virtools show 'script hidden' if we want to view or edit the script further.

However, with the logic data remaining inside Virtools files, it is possible to recover the graph data that is, maybe not consistant with the original view, yet readable and has the same function as the original graph data. The process is done using [this repo](https://github.com/BearKidsTeam/VirtoolsScriptDeobfuscation).

In this way, the scripts can now be easily read and modified if we want to create some mods of the game.

Here is a sample of the deobfuscated scripts. The graph of it is generated by algorithms.

![image](/Screenshot/script.png)

## Why are some files missing in this repo?

Because those files contain no script. No need to deobfuscate them.

## What do I need to create mods for *Ballance*?

You will need Virtools Dev whose **version number is less or equal than 3.5 (3.5, 3.0, 2.5 or 2.1)**. *Ballance* is created by Virtools Dev 2.1. If the version is too high, *Ballance* might be unable to read your modified data.

## Bugs

The release is still not perfect, for these reasons:

* Some functions of 2D Sprites are broken because their inner data types are not recognized by newer version of Virtools;
* As a result, some visual elements in *Ballance* will be uglier if you replace the files by the deobfuscated ones;
* Some links in the graph are in a mess and you need to be patient to straighten them out.


# Ballance Modding

用于修改 [*Ballance*](https://en.wikipedia.org/wiki/Ballance) (一款游戏) 的文件。

## 这些文件是什么？

这些文件由 Virtools 创建，包含了游戏的逻辑脚本与数据，可以在 *Ballance* 的安装目录下找到这些文件。这个仓库里所包含的是这些文件的反混淆版本，便于 Modder 查阅和修改。

## 什么是反混淆版本？为什么要反混淆？

Virtools 基于控制流图（Control Flow Graph）编程，可以使用编辑器内的 Schematic View 进行开发，但是 *Ballance* 在发布时删掉了图的结构信息，在 Virtools 中则显示为 `--Script Hidden--`，避免了其他人使用 Virtools 直接进行编辑和修改。

不过这些文件仍然保留了功能逻辑的信息，因此可以尝试从中恢复出原始的控制流图。虽然可能布局上有差异，但是基本上是可以阅读的，功能上也原版保持了一致。这项工作由 [这个程序](https://github.com/BearKidsTeam/VirtoolsScriptDeobfuscation) 完成。

这些反混淆后的文件可以很方便的阅读和修改，也可以用来开发游戏的 Mod。

下面是一个反混淆后的脚本，图的结构信息是由算法生成的。

![image](/Screenshot/script.png)

## 为什么有些文件不在这里？

因为这些文件不包含脚本信息，所以不需要对它们做反混淆处理。

## 为了给 *Ballance* 开发 Mod，还需要做什么？

需要一个版本 **不高于 3.5（3.5、3.0、2.5或2.1）** 的 Virtools Dev。Ballance 是由 Virtools Dev 2.1 开发的。如果版本太高，*Ballance* 可能会无法读取修改后的数据。

## 已知问题

目前这个版本仍然有一些问题：

* 由于内部数据无法被高版本的 Virtools Dev 所解析，部分 2D Sprites 损坏了
* 基于上面的这个问题，如果用反混淆版本直接替换原始文件，游戏内的一些界面元素会变的很奇怪
* 一些线连的很乱，需要耐心的进行调整和整理
